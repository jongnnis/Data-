<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>homework</title>
    <style>
        #up, #down {width: 500px; text-align: center; border: 0.5px solid black;}
    </style>
</head>
<body>
    <h2>2022 고속도로 상시 시간대별 교통량</h2>
    <div id="container">
        <div id="dirup">
            <p>상행선</p>
            <table id="up">
                <tr id="dayUp">
                    <th>일</th>
                    <th>일별 교통량</th>
                    <!-- <th>순위</th> -->
                </tr>
            </table>
            <p>하행선</p>
            <table id="down">
                <tr id="dayDown">
                    <th>일</th>
                    <th>일별 교통량</th>
                </tr>
            </table>
        </div>
        <div id="dirDown"></div>
    </div>

    <script>
        fetch('https://apis.data.go.kr/1613000/KICTopenAPI/itmsh?serviceKey=pfd4dRtU1pToMhVnnHd%2Fc%2Bf1ZzzxJB6LVx4vEo4pDb7mkR03a4x6I59qRDPT2armrzGE9XYZvXV7D8VtSyEsKg%3D%3D&year=2022&dtype=1&output=json&pageNo=1&month=11&numOfRows=60')
        .then((response)=> {
            return response.json()
        })
        .then((datas)=> {
            // console.log(datas)
            const data = datas.traffic

            //상행선 도로
            const dirUp = data.filter((data) => data.direction === 1)
            console.log(dirUp)
            //하행선 도로
            const dirDown = data.filter((data) => data.direction === 2)
            console.log(dirDown)

            // 일별 교통량 비교(상행)
            const dayUp = document.getElementById('up')
            for (let i=0; i<30; i++){
                const row = document.createElement('tr')
                const day = document.createElement('td')
                day.textContent = `${i+1}일`
                const traffic = document.createElement('td')
                traffic.textContent = dirUp[i].total_count
                row.appendChild(day)
                row.appendChild(traffic)
                dayUp.appendChild(row)
            }

            // 일별 교통량 비교(하행)
            const dayDown = document.getElementById('down')
            for (let i=0; i<30; i++){
                const row = document.createElement('tr')
                const day = document.createElement('td')
                day.textContent = `${i+1}일`
                const traffic = document.createElement('td')
                traffic.textContent = dirDown[i].total_count
                row.appendChild(day)
                row.appendChild(traffic)
                dayDown.appendChild(row)
            }
            
            // 시간대별 평균 교통량 비교(상행)
            // let timeTraffic = []
            // for (let i=4; i<28; i++){
            //     let sum = 0
            //     for (let k=0; k<30; k++){
            //         sum += dirUp[k][i]
            //     }
            //     timeTraffic.push(sum)
            // }
            // console.log(timeTraffic)
            console.log(dirUp[0])
        })
    </script>
</body>
</html>